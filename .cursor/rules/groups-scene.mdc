---
name: groups-scene
description: R√®gles strictes pour Groups Scene - Validation format
globs:
  - "**/*.{py,js,jsx,ts,tsx}"
---

# Groups Scene - R√®gles Strictes

## üéØ Objectif

Assurer validation stricte du format Groups Scene selon standards Scene.

---

## üìã R√®gles Obligatoires

### 1. Format Groupe Scene

**Format standard** :
- ‚úÖ Lettres majuscules uniquement (A-Z)
- ‚úÖ Chiffres autoris√©s (0-9)
- ‚úÖ Longueur minimale : 2 caract√®res
- ‚úÖ Longueur maximale : 100 caract√®res
- ‚úÖ Pas d'espaces, caract√®res sp√©ciaux, accents

**Regex** :
```python
import re

GROUP_PATTERN = re.compile(r'^[A-Z0-9]{2,100}$')

def validate_group(group: str) -> tuple[bool, list[str]]:
    """Valide format groupe Scene."""
    errors = []
    
    if not group or len(group.strip()) == 0:
        errors.append("Le nom du groupe est requis")
    elif len(group) < 2:
        errors.append("Le nom du groupe doit contenir au moins 2 caract√®res")
    elif len(group) > 100:
        errors.append("Le nom du groupe ne peut pas d√©passer 100 caract√®res")
    elif not GROUP_PATTERN.match(group):
        errors.append("Le nom du groupe doit contenir uniquement lettres majuscules et chiffres")
    
    return len(errors) == 0, errors
```

### 2. Validation UI

**Frontend** :
- ‚úÖ Input texte avec validation temps r√©el
- ‚úÖ Autocomplete suggestions groupes existants
- ‚úÖ Message erreur si format invalide
- ‚úÖ Bouton "Suivant" disabled si invalide

**Exemples valides** :
- `TESTGROUP`
- `TEST123`
- `ABC`
- `ABCDEFGHIJK`

**Exemples invalides** :
- `testgroup` (minuscules)
- `Test Group` (espaces)
- `T` (trop court)
- `Test-Group` (caract√®res sp√©ciaux)
- `T√©stGroup` (accents)

### 3. Stockage Backend

**Structure** :
```python
# Table groups
groups (
    id INT PRIMARY KEY,
    name VARCHAR(100) UNIQUE NOT NULL,
    description TEXT,
    created_at DATETIME
)

# Table user_groups (many-to-many)
user_groups (
    user_id INT,
    group_id INT,
    PRIMARY KEY (user_id, group_id)
)
```

**Validation** :
- ‚úÖ Format v√©rifi√© avant insertion
- ‚úÖ Unicit√© `name` garantie (UNIQUE)
- ‚úÖ Normalisation automatique (uppercase)

### 4. Autocomplete Groupes

**Source donn√©es** :
- Groupes existants en base de donn√©es
- Groupes utilis√©s dans releases
- Suggestions tri√©es par fr√©quence d'utilisation

**UI** :
- Dropdown suggestions lors saisie
- Filtrage par pr√©fixe
- S√©lection ou saisie libre

---

## üîç Validation Stricte

### Backend

**Avant sauvegarde** :
- ‚úÖ Validation format regex
- ‚úÖ Normalisation uppercase
- ‚úÖ V√©rification unicit√©
- ‚úÖ Longueur v√©rifi√©e

### Frontend

**Validation temps r√©el** :
- ‚úÖ V√©rification format pendant saisie
- ‚úÖ Message erreur instantan√©
- ‚úÖ Bouton d√©sactiv√© si invalide

---

## üö® Points Critiques

### Format Strict

**R√®gle absolue** : Format Scene strict (majuscules, chiffres uniquement, 2-100 caract√®res).

**Pas d'exception** : Conformit√© absolue requise.

### Normalisation

**Automatique** : Conversion automatique en majuscules si n√©cessaire.

**Avant validation** : Normalisation puis validation.

---

## üìö R√©f√©rences

- **PRD-002** : `docs/PRDs/PRD-002-Nouvelle-Release.md` (√âtape 1)
- **Database ERD** : `docs/DATABASE_ERD.md` (table `groups`, `user_groups`)
- **API Reference** : `docs/API_REFERENCE.md` (endpoints groups)

---

**Derni√®re mise √† jour** : 2025-11-01  
**Version** : 1.0.0  
**Priorit√©** : CRITIQUE ‚ö†Ô∏è
