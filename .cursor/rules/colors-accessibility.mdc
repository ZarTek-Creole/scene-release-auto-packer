---
name: colors-accessibility
description: R√®gles strictes pour Couleurs et Accessibilit√© - Variables CSS, contraste WCAG 2.2 AA, focus visible
globs:
  - "**/*.{ts,tsx,js,jsx,css,scss}"
---

# Couleurs et Accessibilit√© - eBook Scene Packer v2

## üéØ Principe Fondamental

**Couleurs adaptatives et accessibles** : Toutes les couleurs DOIVENT utiliser variables CSS avec support th√®me jour/nuit et respecter WCAG 2.2 AA (contraste ‚â• 4.5:1).

---

## üö® R√àGLES ABSOLUES

### 1. Variables CSS Obligatoires
- ‚úÖ **TOUJOURS** utiliser variables CSS pour couleurs
- ‚úÖ **JAMAIS** couleurs hardcod√©es (#ffffff, rgb(), etc.)
- ‚úÖ **Support th√®me** : Toutes couleurs adaptatives jour/nuit

### 2. Contraste WCAG 2.2 AA
- ‚úÖ **Texte normal** : Ratio ‚â• 4.5:1
- ‚úÖ **Texte large (18px+)** : Ratio ‚â• 3:1
- ‚úÖ **√âl√©ments interactifs** : Ratio ‚â• 3:1
- ‚úÖ **V√©rification** : Outils de v√©rification contraste (WebAIM)

### 3. Focus Visible
- ‚úÖ **Outline** : 2px couleur primaire
- ‚úÖ **Offset** : 2px (outline-offset)
- ‚úÖ **TOUJOURS** visible (pas de outline: none sans alternative)

---

## üé® Variables CSS Couleurs

### Couleurs Principales

```css
:root {
  /* Th√®me Clair (Jour) */
  --color-primary: #0d6efd;
  --color-bg: #ffffff;
  --color-text: #212529;
  --text-secondary: #6c757d;
  --text-muted: #adb5bd;
  
  /* Couleurs √âtat */
  --state-success-bg: #d1e7dd;
  --state-success-text: #0f5132;
  --state-error-bg: #f8d7da;
  --state-error-text: #842029;
  --state-warning-bg: #fff3cd;
  --state-warning-text: #664d03;
  --state-info-bg: #cff4fc;
  --state-info-text: #055160;
}

[data-theme="dark"] {
  /* Th√®me Sombre (Nuit) */
  --color-primary: #4dabf7;
  --color-bg: #1a1d20;
  --color-text: #f8f9fa;
  --text-secondary: #adb5bd;
  --text-muted: #6c757d;
  
  /* Couleurs √âtat (adapt√©es th√®me sombre) */
  --state-success-bg: #2b8a3e;
  --state-success-text: #d3f9d8;
  --state-error-bg: #c92a2a;
  --state-error-text: #ffc9c9;
  --state-warning-bg: #f59f00;
  --state-warning-text: #fff9db;
  --state-info-bg: #1c7ed6;
  --state-info-text: #d0ebff;
}
```

---

## ‚ôø Accessibilit√© WCAG 2.2 AA

### Contraste Couleurs

**Obligatoire** :
- Texte sur fond : Ratio ‚â• 4.5:1
- Texte large (18px+) : Ratio ‚â• 3:1
- √âl√©ments interactifs : Ratio ‚â• 3:1

**V√©rification** :
```bash
# Utiliser WebAIM Contrast Checker ou √©quivalent
# URL : https://webaim.org/resources/contrastchecker/
```

### Focus Visible

```css
/* ‚úÖ Obligatoire : Focus visible */
*:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* ‚ùå JAMAIS : Supprimer focus sans alternative */
button:focus {
  outline: none;  /* ‚ùå INTERDIT */
}

/* ‚úÖ Alternative : Focus visible personnalis√© */
button:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
  box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.25);
}
```

### Skip Links

```tsx
// ‚úÖ Obligatoire : Skip link pour navigation clavier
<a href="#main-content" className="skip-link">
  Aller au contenu principal
</a>

<style>
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--color-primary);
  color: #fff;
  padding: var(--spacing-2) var(--spacing-4);
  z-index: 1000;
}

.skip-link:focus {
  top: 0;
}
</style>
```

---

## ‚úÖ Usage Correct

### Couleurs

```tsx
// ‚úÖ Bon : Variables CSS
<div style={{ backgroundColor: 'var(--color-bg)', color: 'var(--color-text)' }}>

// ‚úÖ Bon : Classes CSS
<div className="card">  {/* Card utilise variables CSS */}

// ‚ùå √âviter : Couleurs hardcod√©es
<div style={{ backgroundColor: '#ffffff', color: '#212529' }}>
```

### Contraste

```css
/* ‚úÖ Bon : Contraste v√©rifi√© WCAG 2.2 AA */
.text-primary {
  color: var(--text-primary);  /* #212529 sur #ffffff = 12.6:1 ‚úÖ */
  background-color: var(--color-bg);
}

.text-secondary {
  color: var(--text-secondary);  /* #6c757d sur #ffffff = 4.8:1 ‚úÖ */
  background-color: var(--color-bg);
}

/* ‚ùå √âviter : Contraste insuffisant */
.text-light {
  color: #cccccc;  /* Sur #ffffff = 1.6:1 ‚ùå < 4.5:1 */
}
```

---

## üö´ Anti-Patterns

### ‚ùå Couleurs Hardcod√©es
```css
/* ‚ùå Mauvais */
.button {
  background-color: #0d6efd;
  color: #ffffff;
}

/* ‚úÖ Bon */
.button {
  background-color: var(--color-primary);
  color: var(--text-inverse);
}
```

### ‚ùå Focus Invisible
```css
/* ‚ùå Mauvais */
button:focus {
  outline: none;
}

/* ‚úÖ Bon */
button:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}
```

### ‚ùå Contraste Insuffisant
```css
/* ‚ùå Mauvais : Contraste < 4.5:1 */
.text-light {
  color: #cccccc;  /* Sur fond blanc */
}

/* ‚úÖ Bon : Contraste ‚â• 4.5:1 */
.text-light {
  color: var(--text-secondary);  /* V√©rifi√© ‚â• 4.5:1 */
}
```

---

## ‚úÖ Checklist Accessibilit√©

### Couleurs
- [ ] Variables CSS utilis√©es (pas de hardcod√©es)
- [ ] Support th√®me jour/nuit
- [ ] Contraste v√©rifi√© (‚â• 4.5:1 texte normal)
- [ ] Contraste v√©rifi√© (‚â• 3:1 texte large)

### Focus
- [ ] Focus visible (outline 2px)
- [ ] Focus offset 2px
- [ ] Tous √©l√©ments interactifs focusables

### Navigation Clavier
- [ ] Tab order logique
- [ ] Skip links pr√©sents
- [ ] √âv√©nements clavier (Enter, Space, Escape)

---

## üìö R√©f√©rences

- **WCAG 2.2** : https://www.w3.org/WAI/WCAG22/quickref/
- **WebAIM Contrast Checker** : https://webaim.org/resources/contrastchecker/
- **Design System** : `docs/DESIGN_SYSTEM_UI_UX.md` (sections Couleurs, Accessibilit√©)
- **R√®gle Design System** : `.cursor/rules/design-system-ui-ux.mdc`

---

**Derni√®re mise √† jour** : 2025-11-01  
**Version** : 1.0.0  
**Priorit√©** : CRITIQUE ‚ö†Ô∏è
