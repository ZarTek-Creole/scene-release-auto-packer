---
alwaysApply: true
---
---
name: definition-of-done
description: R√®gles strictes de Definition of Done - Aucune progression si √©tape/phase non compl√©t√©e √† 100% avec tests
globs:
  - "**/*.{py,js,jsx,ts,tsx,md}"
---

# Definition of Done - R√®gles Strictes v2

## üö® R√àGLE ABSOLUE

**‚ùå JAMAIS continuer √† l'√©tape/phase suivante si l'√©tape/phase en cours n'est pas compl√©t√©e √† 100% avec tests √† 100% et couverture minimale 90%.**

---

## ‚úÖ Definition of Done (DoD) - Obligatoire

### Pour Chaque √âtape

Une √©tape est consid√©r√©e **compl√©t√©e √† 100%** si et seulement si **TOUS** ces crit√®res sont satisfaits :

#### 1. Code Impl√©ment√© ‚úÖ
- [ ] Toutes les fonctionnalit√©s de l'√©tape impl√©ment√©es
- [ ] Code conforme aux conventions du projet
- [ ] Code document√© (docstrings, comments)
- [ ] Pas de code mort ou comment√©
- [ ] Type hints pr√©sents (Python)

#### 2. Tests Obligatoires ‚úÖ
- [ ] **100% des fonctionnalit√©s test√©es**
- [ ] Tests unitaires √©crits et passent
- [ ] Tests d'int√©gration √©crits et passent (si applicable)
- [ ] Tests E2E √©crits et passent (si applicable)
- [ ] Aucun test en √©chec
- [ ] Pas de tests flaky ou instables

#### 3. Couverture de Tests ‚úÖ
- [ ] **Couverture minimale : 90%**
- [ ] **Couverture id√©ale : 100%**
- [ ] Couverture v√©rifi√©e avec `pytest --cov`
- [ ] Rapport coverage HTML g√©n√©r√©
- [ ] Aucune ligne non test√©e dans fonctionnalit√©s critiques

#### 4. Validation et Revue ‚úÖ
- [ ] Code review effectu√© (auto ou manuel)
- [ ] Linters passent (pylint, ESLint)
- [ ] Formateurs passent (black, isort, Prettier)
- [ ] Aucune vuln√©rabilit√© de s√©curit√© identifi√©e
- [ ] Performance acceptable

#### 5. Documentation ‚úÖ
- [ ] Code document√© (docstrings)
- [ ] DEVBOOK mis √† jour (√©tape marqu√©e comme termin√©e)
- [ ] TodoList mise √† jour (t√¢ches marqu√©es comme compl√©t√©es)
- [ ] PRD mis √† jour si fonctionnalit√© modifi√©e
- [ ] README mis √† jour si structure change

#### 6. Int√©gration Continue ‚úÖ
- [ ] Tous tests passent en CI/CD
- [ ] Coverage v√©rifi√© automatiquement
- [ ] Build r√©ussi

---

### Pour Chaque Phase

Une phase est consid√©r√©e **compl√©t√©e √† 100%** si et seulement si **TOUS** ces crit√®res sont satisfaits :

#### 1. Toutes √âtapes Compl√©t√©es ‚úÖ
- [ ] **100% des √©tapes de la phase sont compl√©t√©es √† 100%**
- [ ] Aucune √©tape en cours ou incompl√®te
- [ ] Toutes les d√©pendances r√©solues

#### 2. Tests Phase Compl√®te ‚úÖ
- [ ] Tests de phase √©crits et passent
- [ ] Tests de r√©gression passent
- [ ] Tests de performance passent (si applicable)
- [ ] **Couverture globale phase : ‚â•90%**

#### 3. Documentation Phase ‚úÖ
- [ ] DEVBOOK mis √† jour (phase marqu√©e comme termin√©e)
- [ ] TodoList mise √† jour
- [ ] Rapport de phase cr√©√© si n√©cessaire
- [ ] Risques mis √† jour

#### 4. Validation Phase ‚úÖ
- [ ] Objectifs phase atteints
- [ ] OKRs phase valid√©s
- [ ] Aucun blocker restant
- [ ] Review phase effectu√©e

---

## üö´ Interdictions Absolues

### ‚ùå PROGRESSION INTERDITE

**JAMAIS autoris√© de :**

1. **Passer √† l'√©tape suivante** si l'√©tape actuelle n'est pas compl√©t√©e √† 100%
   ```python
   # ‚ùå INTERDIT
   # √âtape 1.1 : 80% compl√®te, tests passent mais coverage 85%
   # ‚Üí Passer √† √©tape 1.2
   
   # ‚úÖ OBLIGATOIRE
   # √âtape 1.1 : 100% compl√®te, tests 100%, coverage 95%
   # ‚Üí Maintenant on peut passer √† √©tape 1.2
   ```

2. **Passer √† la phase suivante** si la phase actuelle n'est pas compl√©t√©e √† 100%
   ```python
   # ‚ùå INTERDIT
   # Phase 0 : 95% compl√®te, une √©tape manque tests
   # ‚Üí Passer √† Phase 1
   
   # ‚úÖ OBLIGATOIRE
   # Phase 0 : 100% compl√®te, toutes √©tapes 100%, tests 100%
   # ‚Üí Maintenant on peut passer √† Phase 1
   ```

3. **Merger code** si coverage < 90%
   ```python
   # ‚ùå INTERDIT
   # Coverage : 85%
   # ‚Üí Merge
   
   # ‚úÖ OBLIGATOIRE
   # Coverage : 92%
   # ‚Üí Merge autoris√©
   ```

4. **Ignorer tests en √©chec**
   ```python
   # ‚ùå INTERDIT
   # 3 tests √©chouent mais on continue
   
   # ‚úÖ OBLIGATOIRE
   # Tous tests doivent passer avant continuation
   ```

---

## üîç V√©rification Obligatoire

### Checklist Avant Progression

**Avant de passer √† l'√©tape suivante** :

```bash
# 1. V√©rifier tests passent
pytest tests/ -v
# ‚Üí DOIT afficher : "X passed"

# 2. V√©rifier coverage
pytest --cov=web --cov=src --cov-report=term
# ‚Üí DOIT afficher : coverage ‚â•90%

# 3. V√©rifier linters
pylint web/ src/
# ‚Üí DOIT afficher : "Your code has been rated at 10.00/10"

# 4. V√©rifier formatage
black --check web/ src/
isort --check web/ src/
# ‚Üí DOIT afficher : "All done!"

# 5. Mettre √† jour DEVBOOK
# ‚Üí Marquer √©tape comme ‚úÖ Termin√©e
```

### Checklist Avant Progression Phase

**Avant de passer √† la phase suivante** :

```bash
# 1. V√©rifier toutes √©tapes compl√©t√©es
# ‚Üí DEVBOOK : toutes √©tapes ‚úÖ

# 2. Tests phase compl√®te
pytest tests/ --cov=web --cov=src
# ‚Üí Coverage ‚â•90%

# 3. Documentation √† jour
# ‚Üí DEVBOOK, TodoList, PRDs mis √† jour

# 4. Review phase
# ‚Üí Objectifs atteints, OKRs valid√©s
```

---

## üìä M√©triques Obligatoires

### Pour Chaque √âtape

- **Compl√©tion fonctionnelle** : 100%
- **Compl√©tion tests** : 100%
- **Couverture tests** : ‚â•90% (id√©al 100%)
- **Tests passants** : 100%
- **Documentation** : 100%

### Pour Chaque Phase

- **Compl√©tion √©tapes** : 100%
- **Couverture globale** : ‚â•90%
- **Tests phase** : 100% passants
- **Documentation phase** : 100% √† jour

---

## ‚úÖ Exemple Concret

### Sc√©nario : √âtape 1.1 - Setup Flask App Factory

#### ‚úÖ √âtape Compl√©t√©e √† 100%

**Code** :
```python
# web/app.py cr√©√© ‚úÖ
def create_app(config_name='development'):
    """Application factory."""
    app = Flask(__name__)
    # ... impl√©mentation compl√®te ‚úÖ
    return app
```

**Tests** :
```python
# tests/unit/test_app.py
def test_create_app_dev():
    """Test cr√©ation app dev."""
    app = create_app('development')
    assert app.config['DEBUG'] is True  # ‚úÖ Passe

def test_create_app_prod():
    """Test cr√©ation app prod."""
    app = create_app('production')
    assert app.config['DEBUG'] is False  # ‚úÖ Passe
```

**Coverage** :
```bash
$ pytest --cov=web/app
coverage: 95% ‚úÖ (‚â•90%)
```

**Documentation** :
- DEVBOOK mis √† jour : √âtape 1.1 ‚úÖ
- TodoList mise √† jour : √âtape 1.1 ‚úÖ

**Validation** :
- Tous tests passent ‚úÖ
- Coverage 95% ‚úÖ
- Linters passent ‚úÖ

**‚Üí √âtape 1.1 COMPL√âT√âE √Ä 100% ‚Üí On peut passer √† √âtape 1.2 ‚úÖ**

#### ‚ùå √âtape NON Compl√©t√©e (Progression Interdite)

**Code** :
```python
# web/app.py cr√©√© mais incomplet
def create_app(config_name='development'):
    """Application factory."""
    app = Flask(__name__)
    # TODO: Configurer blueprints  # ‚ùå Incomplet
    return app
```

**Tests** :
```python
# tests/unit/test_app.py
def test_create_app_dev():
    """Test cr√©ation app dev."""
    app = create_app('development')
    assert app.config['DEBUG'] is True  # ‚úÖ Passe

# ‚ùå MANQUE : test_create_app_prod
```

**Coverage** :
```bash
$ pytest --cov=web/app
coverage: 75% ‚ùå (<90%)
```

**Documentation** :
- DEVBOOK non mis √† jour ‚ùå

**‚Üí √âtape 1.1 NON COMPL√âT√âE ‚Üí PROGRESSION INTERDITE ‚ùå**

---

## üéØ Application √† Phase 0

### Phase 0 Doit √ätre √† 100% Avant Phase 1

**Crit√®res Phase 0 compl√©t√©e** :

1. ‚úÖ Backup v1/ cr√©√© et v√©rifi√©
2. ‚úÖ Documentation structur√©e compl√®te (10 fichiers)
3. ‚úÖ R√®gles Cursor cr√©√©es (5 r√®gles + guide)
4. ‚úÖ Environnement d√©veloppement configur√©
5. ‚úÖ Setup TDD fonctionnel
6. ‚úÖ Tests de validation passent
7. ‚úÖ Coverage tests ‚â•90% (id√©al 100%)
8. ‚úÖ DEVBOOK mis √† jour
9. ‚úÖ TodoList mise √† jour
10. ‚úÖ Tous fichiers valid√©s

**Seulement quand TOUS ces crit√®res sont satisfaits** ‚Üí Phase 1 peut commencer.

---

## üìù Processus de Validation

### Workflow Validation √âtape

```
1. Impl√©menter fonctionnalit√©
   ‚Üì
2. √âcrire tests (TDD)
   ‚Üì
3. V√©rifier tests passent √† 100%
   ‚Üì
4. V√©rifier coverage ‚â•90%
   ‚Üì
5. V√©rifier linters/formatage
   ‚Üì
6. Mettre √† jour documentation
   ‚Üì
7. Marquer √©tape comme ‚úÖ dans DEVBOOK
   ‚Üì
8. VALID√â ‚Üí Peut passer √† √©tape suivante
```

### Workflow Validation Phase

```
1. V√©rifier toutes √©tapes compl√©t√©es
   ‚Üì
2. Tests phase compl√®te (coverage ‚â•90%)
   ‚Üì
3. Documentation phase √† jour
   ‚Üì
4. Review phase
   ‚Üì
5. Marquer phase comme ‚úÖ dans DEVBOOK
   ‚Üì
6. VALID√â ‚Üí Peut passer √† phase suivante
```

---

## üîó Liens

- **TDD Methodology** : `.cursor/rules/tdd-methodology.mdc`
- **Testing Requirements** : `.cursor/rules/testing-requirements.mdc`
- **DEVBOOK** : `docs/DEVBOOK.md`
- **TodoList** : `docs/todolist.md`

---

## ‚ö†Ô∏è Rappel Critique

**Cette r√®gle est ABSOLUE et NON N√âGOCIABLE.**

Aucune exception n'est autoris√©e. Si une √©tape/phase n'est pas compl√©t√©e √† 100% avec tests et coverage ‚â•90%, **LA PROGRESSION EST INTERDITE**.

**Mieux vaut compl√©ter √† 100% que progresser √† 95%.**

---

**Derni√®re mise √† jour** : 2025-11-01  
**Version** : 1.0.0  
**Priorit√©** : CRITIQUE ‚ö†Ô∏è
